welcome to cart page

<br />



{{#if infoMessage}}
<p class="alert alert-success">{{infoMessage}}</p>
{{/if}}
{{#if errorMessage}}
<p class="alert alert-danger">{{errorMessage}}</p>
{{/if}}


Dear {{firstName}}{{lasttName}},

<table class="table" id="customer-cart">
  <thead class="thead-dark">
    <tr>
      <th scope="col">#</th>
      <th scope="col">Product</th>
      <th scope="col">Quantity</th>
      <th scope="col">Cost</th>
      <th scope="col">Remove</th>
    </tr>
  </thead>
  <tbody>
    {{#each products }}
    <tr class="product">
      <th scope="row">1</th>
      <td> {{ productId.name}} </td>
      {{!-- <td> <input name="quantity" value={{quantity}} /> </td> --}}
      <td>
        <div>
          <a class="btn btn-primary" href='/cart/incProduct/{{productId.productId}}'> - </a>
          <span class="quantity"> {{ quantity}} </span>
          {{!-- <a class="btn btn-primary" href='/cart/decProduct/{{productId.productId}}'> + </a> --}}
          <button class="btn btn-primary" onclick={incQuantity("{{productId._id}}")}> + </button>
        </div>
      </td>
      <td>{{ productId.price}}</td>
      <td> <input type="hidden" id="productId" name="productId" value={{productId._id}}> </td>
      <td> <button class="btn btn-danger" onclick={deleteProduct("{{productId._id}}")}> Delete</button>
      </td>
    </tr>

    {{/each}}
  </tbody>
</table>

<a class="btn btn-primary" href="/shop/"> Back to Shop </a>
<button class="btn btn-primary" type="submit"> Check Out </button>

<script>
  /**
  *  triggers when "delete" button is clicked 
  */
  const deleteProduct = id => {
    //confirmation of deletion
    console.log("DELETE PRODUCT CLICKED")
    // console.log(id)
    const urlId = `http://localhost:3000/cart/deleteProduct/${id}`;
    console.log(urlId)

    axios
      .delete(urlId)
      .then(response => {
        console.log(" response from server ");
        console.log(response.data);
      })
      .catch(err => console.log(`Err while deleting product: ${err}`));
  };

  /**
  *  triggers when "+" button is clicked  for quantity
  */
  const incQuantity = id => {
    // increase the quantity
    //  console.log("INCREASE PRODUCT  CLICKED")
    // console.log(id)
    const urlId = `http://localhost:3000/cart/incQty/${id}`;
    //  console.log(urlId)

    axios
      .get(urlId)
      .then(response => {
        console.log(response);
        console.log(response.data[0].quantity);
        let allProducts = document.querySelectorAll('.product');
        Array.from(allProducts).forEach(ele => {
          console.log(ele.querySelector('input').value, ele.querySelector('span').textContent)
          if (id == ele.querySelector('input').value) {

            ele.querySelector('.quantity').textContent = response.data[0].quantity;
          }

        });

        // console.log(" response from server for increment quantity")
        // console.log(response.data);
        // console.log(response.data[0]);
        //  console.log(response.data[0].quantity);
        //  console.log(document.querySelector("#customer-cart .quantity"));


      })
      .catch(err => console.log(`Err while increasing product quantity: ${err}`));
  };
</script>